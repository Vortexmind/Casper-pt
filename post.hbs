{{!< default}}

{{!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template --}}

<header class="site-header">
    {{> site-header}}
</header>

{{!-- Everything inside the #post tags pulls data from the post --}}
{{#post}}

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full {{post_class}} {{#unless feature_image}}no-image{{/unless}}">

            <header class="post-full-header">

                {{#if primary_tag}}
                <section class="post-full-tags">
                    {{#primary_tag}}
                    <a href="{{url}}">{{name}}</a>
                    {{/primary_tag}}
                </section>
                {{/if}}

                <h1 class="post-full-title">{{title}}</h1>

                {{#if custom_excerpt}}
                <p class="post-full-custom-excerpt">{{custom_excerpt}}</p>
                {{/if}}

                <div class="post-full-byline">

                    <section class="post-full-byline-content">

                        <ul class="author-list">
                            {{#foreach authors}}
                            <li class="author-list-item">

                                <div class="author-card">
                                    {{#if profile_image}}
                                    <img class="author-profile-image" src="{{img_url profile_image size="xs"}}" alt="{{name}}" />
                                    {{else}}
                                    <div class="author-profile-image">{{> "icons/avatar"}}</div>
                                    {{/if}}
                                    <div class="author-info">
                                        {{#if bio}}
                                        <div class="bio">
                                            <h2>{{name}}</h2>
                                            <p>{{bio}}</p>
                                            <p><a href="{{url}}">More posts</a> by {{name}}.</p>
                                        </div>
                                        {{else}}
                                        <h2>{{name}}</h2>
                                        <p>Read <a href="{{url}}">more posts</a> by this author.</p>
                                        {{/if}}
                                    </div>
                                </div>

                                {{#if profile_image}}
                                <a href="{{url}}" class="author-avatar">
                                    <img class="author-profile-image" src="{{img_url profile_image size="xs"}}" alt="{{name}}" />
                                </a>
                                {{else}}
                                <a href="{{url}}" class="author-avatar author-profile-image">{{> "icons/avatar"}}</a>
                                {{/if}}

                            </li>
                            {{/foreach}}
                        </ul>

                        <section class="post-full-byline-meta">
                            <h4 class="author-name">{{authors}}</h4>
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="{{date format="YYYY-MM-DD"}}">{{date format="D MMM YYYY"}}</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> {{reading_time}}</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            {{#if feature_image}}
                {{> "feature-image"}}
            {{/if}}

            <section class="post-full-content">
                <div class="post-content">
                    {{content}}
                </div>
                <div class="post-twitter-cta">
                    <a href="https://www.twitter.com/vortexmind" title="Follow Paolo on Twitter" target="_blank">
                        <img src="data:image/png;base64,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" alt="Follow Paolo on Twitter" />If you liked this article, follow me on Twitter for more updates
                    </a>
                </div>
            </section>

            {{!-- Email subscribe form at the bottom of the page --}}
            {{#if @labs.members}}
                {{> subscribe-form}}
            {{/if}}

            <section class="post-full-comments">
                <h2>Comments</h2>
                <p>This site uses Akismet to reduce spam. <a href="https://akismet.com/privacy/" rel="noopener">Learn how your comment data is processed</a>.</p>
                <p>Comments are moderated so there will be a delay before your comment is published.</p>
                <div id="commento"></div>
                <script defer data-auto-init="false" src="https://commento.paolotagliaferri.com/js/commento.js" type="text/javascript"></script>
            </section>

        </article>

    </div>
</main>

{{!-- Links to Previous/Next posts --}}
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            {{#if primary_tag}}
            {{#get "posts" filter="tags:{{primary_tag.slug}}+id:-{{id}}" limit="3" as |related_posts|}}
                {{#if related_posts}}
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        {{#../primary_tag}}
                        <h3><span>More in</span> <a href="{{url}}">{{name}}</a></h3>
                        {{/../primary_tag}}
                    </header>
                    <div class="read-next-card-content">
                        <ul>
                            {{#foreach related_posts}}
                            <li>
                                <h4><a href="{{url}}">{{title}}</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="{{date format="YYYY-MM-DD"}}">{{date format="D MMM YYYY"}}</time> –
                                        {{reading_time}}</p>
                                </div>
                            </li>
                            {{/foreach}}
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="{{#../primary_tag}}{{url}}{{/../primary_tag}}">{{plural meta.pagination.total empty='No posts' singular='% post' plural='See all % posts'}}
                            →</a>
                    </footer>
                </article>
                {{/if}}
            {{/get}}
            {{/if}}

            {{!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs --}}
            {{#next_post}}
                {{> "post-card"}}
            {{/next_post}}

            {{!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs --}}
            {{#prev_post}}
                {{> "post-card"}}
            {{/prev_post}}
        </div>
    </div>
</aside>

{{/post}}

{{!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs --}}
{{!-- Credits for commento lazy load:  https://www.dev-eth0.de/2019/07/16/integration-of-commento-into-hugo/#lazy-initialization-optional --}}
{{#contentFor "scripts"}}
<script>
    $(document).ready(function () {
        // FitVids - start
        var $postContent = $(".post-full-content");
        $postContent.fitVids();
        // FitVids - end

        // Replace nav with title on scroll - start
        Casper.stickyNavTitle({
            navSelector: '.site-nav-main',
            titleSelector: '.post-full-title',
            activeClass: 'nav-post-title-active'
        });
        // Replace nav with title on scroll - end

        // Hover on avatar
        var hoverTimeout;
        $('.author-list-item').hover(function () {
            var $this = $(this);

            clearTimeout(hoverTimeout);

            $('.author-card').removeClass('hovered');
            $(this).children('.author-card').addClass('hovered');

        }, function () {
            var $this = $(this);

            hoverTimeout = setTimeout(function () {
                $this.children('.author-card').removeClass('hovered');
            }, 800);
        });
    });
</script>
<script>
    const readingProgress = (contentArea, progressBar) => {
    const content = document.querySelector(contentArea);
    const progress = document.querySelector(progressBar);

    const frameListening = () => {
        const contentBox = content.getBoundingClientRect();
        const midPoint = window.innerHeight / 2;
        const minsRemaining = Math.round(progress.max - progress.value);

        if (contentBox.top > midPoint) {
            progress.value = 0;
        }

        if (contentBox.top < midPoint) {
            progress.value = progress.max;
        }

        if (contentBox.top <= midPoint && contentBox.bottom >= midPoint) {
            progress.value =
                (progress.max * Math.abs(contentBox.top - midPoint)) /
                contentBox.height;
        }

        window.requestAnimationFrame(frameListening);
    };

    window.requestAnimationFrame(frameListening);
};

readingProgress(".post-full-content", ".reading-progress-bar");
</script>
<script>
const observer = new IntersectionObserver(commentsSectionIntersecting);

function commentsSectionIntersecting(entries) {
  entries
    .filter(e => e.isIntersecting)
    .forEach(e => {
      window.commento.main();
      observer.unobserve(e.target);
    });
}

document.addEventListener("DOMContentLoaded", function() {
  const commentsElem = document.getElementById("commento");
  if (commentsElem) {
    if (typeof window.commento.main !== "undefined") {
      observer.observe(commentsElem);
    } else {
      commentsElem.parentNode.removeChild(commentsElem);
    }
  }
});
</script>
{{/contentFor}}
